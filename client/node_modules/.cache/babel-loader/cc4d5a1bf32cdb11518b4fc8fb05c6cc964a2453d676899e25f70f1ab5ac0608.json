{"ast":null,"code":"import React,{useState}from\"react\";import{useHistory}from\"react-router-dom\";import Axios from\"axios\";import\"./LoginForm.css\";import\"bootstrap/dist/css/bootstrap.min.css\";import{useDispatch}from'react-redux';import{setUser}from'./UserSlice';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function LoginForm(_ref){let{setIsLoggedIn,setUserRole}=_ref;const[usuario,setUsuario]=useState(\"\");const[password,setPassword]=useState(\"\");const[idUsuario,setIdUsuario]=useState(\"\");const[rol,setRol]=useState(\"\");const[loginStatus,setLoginStatus]=useState(\"\");const history=useHistory();const dispatch=useDispatch();const login=e=>{e.preventDefault();console.log(\"Usuario:\",usuario,\"Password:\",password);Axios.post(\"http://localhost:3001/auth/login\",{usuario:usuario,password:password}).then(response=>{console.log(\"Respuesta del servidor:\",response.data);console.log(\"Usuario recibido:\",response.data.usuario);if(response.data.message){alert(response.data.message);}else{setIsLoggedIn(true);localStorage.setItem(\"isLoggedIn\",\"true\");// Hacer una solicitud GET para obtener el rol y idUsuario del usuario\nAxios.get(\"http://localhost:3001/auth/usuario/\".concat(usuario)).then(response=>{const userRole=response.data.body.rol;const userId=response.data.body.idUsuario;localStorage.setItem(\"userRole\",userRole);setUserRole(userRole);setIdUsuario(userId);const userData={idUsuario:userId,usuario:usuario,rol:userRole};console.log(\"Este es el usuario que estoy enviando\",userData);dispatch(setUser(userData));history.push(\"/inicio\");}).catch(error=>{console.error(\"Error al obtener el rol del usuario:\",error);});}}).catch(error=>{console.error(\"Error de red:\",error);alert(\"Contrase単a o usuario incorrecto\");});};return/*#__PURE__*/_jsx(\"div\",{className:\"loginForm\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:login,children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Inicio de sesion\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"usuario\",children:\"Usuario:\"}),/*#__PURE__*/_jsx(\"input\",{className:\"textInput\",type:\"text\",name:\"usuario\",value:usuario,onChange:e=>setUsuario(e.target.value),placeholder:\"Ingresa tu usuario\",required:true}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:\"Contrase\\xF1a:\"}),/*#__PURE__*/_jsx(\"input\",{className:\"textInput\",type:\"password\",name:\"password\",value:password,onChange:e=>setPassword(e.target.value),placeholder:\"Ingresa tu contrase\\xF1a\",required:true}),/*#__PURE__*/_jsx(\"input\",{className:\"button\",type:\"submit\",value:\"Acceder\"}),/*#__PURE__*/_jsx(\"h1\",{style:{color:\"red\",fontSize:\"15px\",textAlign:\"center\",marginTop:\"20px\"},children:loginStatus})]})});}export default LoginForm;","map":{"version":3,"names":["React","useState","useHistory","Axios","useDispatch","setUser","jsx","_jsx","jsxs","_jsxs","LoginForm","_ref","setIsLoggedIn","setUserRole","usuario","setUsuario","password","setPassword","idUsuario","setIdUsuario","rol","setRol","loginStatus","setLoginStatus","history","dispatch","login","e","preventDefault","console","log","post","then","response","data","message","alert","localStorage","setItem","get","concat","userRole","body","userId","userData","push","catch","error","className","children","onSubmit","htmlFor","type","name","value","onChange","target","placeholder","required","style","color","fontSize","textAlign","marginTop"],"sources":["C:/Users/AUXTIC/Documents/Sellertatpro/Sellertatpro/client/src/login_registro/LoginForm.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport Axios from \"axios\";\nimport \"./LoginForm.css\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport { useDispatch } from 'react-redux';\nimport { setUser } from './UserSlice';\n\nfunction LoginForm({ setIsLoggedIn, setUserRole }) {\n  const [usuario, setUsuario] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [idUsuario, setIdUsuario] = useState(\"\");\n  const [rol, setRol] = useState(\"\");\n  const [loginStatus, setLoginStatus] = useState(\"\");\n  const history = useHistory();\n  const dispatch = useDispatch();\n\n  const login = (e) => {\n    e.preventDefault();\n    console.log(\"Usuario:\", usuario, \"Password:\", password);\n\n    Axios.post(\"http://localhost:3001/auth/login\", {\n      usuario: usuario,\n      password: password\n    })\n    .then((response) => {\n      console.log(\"Respuesta del servidor:\", response.data);\n      console.log(\"Usuario recibido:\", response.data.usuario);\n\n      if (response.data.message) {\n        alert(response.data.message);\n      } else {  \n        setIsLoggedIn(true);\n        localStorage.setItem(\"isLoggedIn\", \"true\");\n\n        // Hacer una solicitud GET para obtener el rol y idUsuario del usuario\n        Axios.get(`http://localhost:3001/auth/usuario/${usuario}`)\n          .then((response) => {\n            const userRole = response.data.body.rol;\n            const userId = response.data.body.idUsuario;\n            localStorage.setItem(\"userRole\", userRole);\n            setUserRole(userRole);\n\n            setIdUsuario(userId);\n\n            const userData = {\n              idUsuario: userId,\n              usuario: usuario,\n              rol: userRole,\n            };\n\n            console.log(\"Este es el usuario que estoy enviando\", userData);\n\n            dispatch(setUser(userData));\n            history.push(\"/inicio\");\n          })\n          .catch((error) => {\n            console.error(\"Error al obtener el rol del usuario:\", error);\n          });\n      }\n    })\n    .catch((error) => {\n      console.error(\"Error de red:\", error);\n      alert(\"Contrase単a o usuario incorrecto\");\n    });\n  };\n\n  return (\n    <div className=\"loginForm\">\n      <form onSubmit={login}>\n        <h4>Inicio de sesion</h4>\n        <label htmlFor=\"usuario\">Usuario:</label>\n        <input\n          className=\"textInput\"\n          type=\"text\"\n          name=\"usuario\"\n          value={usuario}\n          onChange={(e) => setUsuario(e.target.value)}\n          placeholder=\"Ingresa tu usuario\"\n          required\n        />\n        <label htmlFor=\"password\">Contrase単a:</label>\n        <input\n          className=\"textInput\"\n          type=\"password\"\n          name=\"password\"\n          value={password}\n          onChange={(e) => setPassword(e.target.value)}\n          placeholder=\"Ingresa tu contrase単a\"\n          required\n        />\n        <input className=\"button\" type=\"submit\" value=\"Acceder\" />\n        <h1\n          style={{\n            color: \"red\",\n            fontSize: \"15px\",\n            textAlign: \"center\",\n            marginTop: \"20px\",\n         \n         \n          }}\n        >\n          {loginStatus}\n        </h1>\n      </form>\n    </div>\n  );\n}\n\nexport default LoginForm;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}